<script>
    document.addEventListener('DOMContentLoaded', () => {
      // Query elements only after DOM is ready
      const burger   = document.querySelector('.hamburger');
      const menu     = document.querySelector('.mobile-menu');
      const overlay  = document.querySelector('.overlay');
      const closeBtn = document.querySelector('.close-btn');

      const closeMobileMenu = () => {
        if (menu)    menu.classList.remove('open');
        if (overlay) overlay.classList.remove('show');
      };

      if (burger && menu && overlay) {
        burger.addEventListener('click', () => {
          menu.classList.toggle('open');
          overlay.classList.toggle('show');
        });
      } else if (burger) {
        // Fallback: toggle a body class if menu/overlay are missing
        burger.addEventListener('click', () => {
          document.body.classList.toggle('menu-open');
        });
      }

      if (overlay) {
        overlay.addEventListener('click', closeMobileMenu);
      }
      if (closeBtn) {
        closeBtn.addEventListener('click', closeMobileMenu);
      }

      // Mobile accordion toggles
      const toggles = document.querySelectorAll('.mobile-menu .menu-toggle');
      if (toggles && toggles.length) {
        toggles.forEach(btn => {
          btn.addEventListener('click', () => {
            const group = btn.closest('.menu-group');
            if (!group) return;
            const nowOpen = group.classList.toggle('open');
            btn.setAttribute('aria-expanded', nowOpen ? 'true' : 'false');
          });
          // keyboard support
          btn.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              btn.click();
            }
          });
        });
      }

      // Close mobile menu when a leaf link is clicked
      const mobileLinks = document.querySelectorAll('.mobile-menu a[href]');
      if (mobileLinks && mobileLinks.length) {
        mobileLinks.forEach(a => {
          a.addEventListener('click', closeMobileMenu);
        });
      }
    });
  </script>